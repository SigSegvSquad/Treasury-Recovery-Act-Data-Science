```{r}
library(ggplot2)
library(mlr)

train <- read.csv("Treasury Recovery Act Data as of 9-30-2010.csv")
train
```

```{r}
columns<-colnames(train)
columns
```

```{r}
# data cleaning

toNumeric<-function(str){
  substring <- gsub("\\$","",str)
  substring <- gsub(",","",substring)
  return (as.numeric(substring))
}

for(x in 2:23){
  train[x] <- lapply(train[x], toNumeric)
}

print(train)
```


```{r}
row_sums <- c()

print(train[1,])

valid_columns <- c(2, 3, 4, 5, 6, 7, 9, 10, 11, 13, 15, 17, 19, 21)

for(x in 1:nrow(train)){
  sum <- 0
  for(y in valid_columns){
    sum <- sum + as.numeric(train[x,][y])
  }
  row_sums <- append(row_sums, sum)
}
train["Total.Allocation"] = row_sums

head(train,5)

```


```{r}
ggplot(data = train[1:58,], aes(x = Ã¯..States, y = Total.Allocation)) + geom_point()+ theme(axis.text.x = element_text(hjust = 1, vjust=0.5, angle = 90)) + ggtitle("State Allocation")

```
```{r}

x <- columns[valid_columns]
y <- as.numeric(train[60,])
y <- y[valid_columns]
length(x)
x
length(y)
y

```


```{r}
barplot(y,names.arg=x,xlab="Month",ylab="Revenue",col="blue",
main="Revenue chart",border="red")
```

